<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> 随机游走 | Qi Zhan </title> <meta name="author" content="Qi Zhan"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://qi-zhan.github.io/blog/2023/randomwalk/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Qi </span> Zhan </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">TA </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">随机游走</h1> <p class="post-meta"> October 22, 2023 • 詹奇 </p> <p class="post-tags"> <a href="/blog/2023"> <i class="fa-solid fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/category/math"> <i class="fa-solid fa-tag fa-sm"></i> math</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <blockquote> <p>A drunk man will find his way home, but a drunk bird may get lost forever.</p> </blockquote> <p>本文使用几乎纯组合的方法证明低维随机游走的几个有趣的结论，即一维与二维随机游走的回返性与三维游走的非回返性。</p> <h2 id="一维随机游走">一维随机游走</h2> <p>一维随机游走的定义非常简单：一个动点在每一个时刻 \(n = 1, 2, \dots, 3\) 以概率 \(p\) 向上移动一格，以概率 \(q = 1 - p\) 向下移动一格。当 \(p = q=\frac{1}{2}\) 时，这个游走称为对称的。下面的讨论，我们对只考虑对称的情形。</p> <p>下图为随机游走中的一个时间-空间坐标系，横坐标代表时间，纵坐标代表位置，这样的一条折现就称为运动的<strong>轨迹</strong>。</p> <p align="center"> <img src="/assets/img/randomwalk.png" width="60%"> </p> <h3 id="组合法基础">组合法基础</h3> <p>我们以 \(L(x, y)\) 表示从原点开始到 \((x,y)\)的轨迹的条数。当 \(x, y\) 奇偶性相同且 \(y\le x\) 时，我们有</p> \[L(x, y) = C_x^{(x+y)/2}\] <p>其他情形下，\(L(x,y) = 0\). (证明是显然的，即组合数定义)</p> <p>下面介绍本文最重要的引理——反射原理。</p> <p><strong>反射原理</strong> 假设 \(A(x_0, y_0), B(x, y), A'(x_0, -y_0)\) 是在坐标上的点，且 \(0&lt;x_0&lt;x, y_0&gt;0, y&gt;0\)，那么由 \(A\) 到 \(B\) 的<strong>与横坐标相交</strong>的路线的条数等于由 \(A'\) 到 \(B\) 的所有条数。</p> <p>证明：下图的一一映射道尽一切。</p> <p align="center"> <img src="/assets/img/reflect.png" withd="20%"> </p> <p>在以后的叙述中，我们称路线为正的，如果它的顶点都严格位于横坐标轴上方(除了起始点)；称路线为非负的，如果它没有位于横坐标轴下方的顶点。</p> <p>由反射原理我们可以得到如下推论：</p> <p><strong>引理1</strong> 以原点 \((0,0)\) 为起点，以横坐标 \(x\) 为终点的正路线的总数：1) 当 \(x\) 为偶数时，为 \(C_{x-1}^{x/2}\)；2) 当 \(x\) 为奇数时，为 \(C_{x-1}^{(x-1)/2}\).</p> <p>证明：首先这样的路线必通过 \((1,1)\)，由 \((1,1)\) 到达横坐标 \(x\) 的路线总数为 \(\sum_{y=y_0}^xL(x-1, y-1)\), 由 \((1, -1)\) 到达横坐标 \(x\) 的路线总数为 \(\sum_{y=y_0}^{x-2}L(x-1, y+1)\), 其中</p> \[y_0 = \begin{cases} 1, &amp; x \text{为奇数} \\ 2, &amp; x \text{为偶数} \end{cases}\] <p>注意求和时 \(y\) 的取值范围，如果是 \((1,-1)\) 开始上界只能到 \(x-2\)。</p> <p>由反射原理我们知道正路线即为他们的差，也就是</p> \[\sum_{y=y_0}^xL(x-1, y-1) -\sum_{y=y_0}^xL(x-1, y+1) = L(x-1, y_0-1) = \begin{cases} C_{x-1}^{(x-1)/2}, &amp; x \text{为奇数} \\ C_{x-1}^{x/2}, &amp; x \text{为偶数} \end{cases}\] <p>一个显然的推论是，以原点 \((0,0)\) 为起点，以横坐标 \(x\) 为终点的正路线和负路线的总数为两倍的正路线，为 \(2C_{2n-1}^n=C_{2n}^n\)，若 \(x=2n\)；为 \(2C_{2n}^n\)，若 \(x=2n+1\).</p> <h3 id="一维随机游走的回返性">一维随机游走的回返性</h3> <p>有了最重要的反射原理及其推论，我们就可以证明一维随机游走的回返性了，即动点在运动后终能回到原点的概率为 \(1\).</p> <p>在考虑这一问题的时候，我们只考虑偶数步回到零的可能，即 \((0,0)\) 到 \((2n, 0)\) 的路线数。 我们以 \(u_{2n}\) 表示动点在第 \(2n\) 步时回到原点的概率，由路线数与总路线数之比可立即推得：</p> \[u_{2n} = \frac{C_{2n}^n}{2^{2n}}\] <p>其次，以 \(f_{2n}\) 表示动点在 \(2n\) 时 <strong>第一次</strong> 回到原点的概率，我们有如下引理：</p> <p><strong>引理2</strong> \(f_{2n} = u_{2n-2} - u_{2n}\) 即第一次回到原点的概率等于在第 \(2n\) 步回到原点的概率减去在第 \(2n-2\) 步回到原点的概率。</p> <p>证明：我们引入 \(A_{2n}\)：在 \(2n\) 步之内，动点一次也未返回原点，也就是正路线和负路线；\(B\) 质点于第 \(2n\) 步返回原点。由上一节的推论我们立刻知道</p> \[P(A_{2n}) = u_{2n}\] <p>我们知道 \(A_{2n-2}\bigcap B\) 表示在第 \(2n\) 步<strong>首次</strong>返回原点，因此 \(P(A_{2n-2}\bigcap B) = f_{2n}\).</p> <p>易知 \((A_{2n-1}\bigcap B)\bigcup(A_{2n-2}\bigcap \bar{B}) = A_{2n-2}\)，而从定义我们可以看到 \(2n\) 步不返回原点的事件数就是 \(2n-2\) 步不返回原点的事件交上 \(2n\) 步不返回原点的事件，也就是 \(A_{2n-2}\bigcap\bar{B}=A_{2n}\)，因此</p> \[\begin{array} P(A_{2n-2}\bigcap B) + P(A_{2n}) &amp;= P(A_{2n-2}) \\ f_{2n} + u_{2n} &amp;= u_{2n-2} \\ f_{2n} &amp;= u_{2n-2} - u_{2n} \end{array}\] <p>有了这一引理，我们立刻可以知道动点在 \(2n\) 步之内返回原点的概率为 \(f_2 + f_4+\dots+f_{2n} = 1 - u_2 - u_4 - \dots - u_{2n} = 1 - u_{2n}\).</p> <p>而斯特林公式告诉我们对于 \(u_{2n}\) 的估计：</p> \[\begin{array} nn! &amp;\approx \sqrt{2\pi n}(\frac{n}{e})^n \\ C_{2n}^n &amp;\approx 2^{2n}\sqrt{\frac{2}{\pi n}} \\ u_{2n} &amp;\approx \frac{1}{\sqrt{\pi n}} \end{array}\] <p>也就有如下定理：</p> <p><strong>定理1</strong> 一维随机游走的回返性：动点以概率 \(1\) 返回原点。</p> <p>除了回返性，随机游走还有许多重要的性质，例如对于动点逗留时间讨论导出的反正弦定理，限于篇幅，这里不再赘述。</p> <h2 id="二维与三维随机游走">二维与三维随机游走</h2> <p>一维随机游走可以自然的推广到更高的维度：二维即在平面上以 \(\frac14\) 的概率向上、下、左、右移动一格；三维即在空间中以 \(\frac16\) 的概率向上、下、左、右、前、后移动一格。</p> <p>首先证明一条引理：</p> <p><strong>引理3</strong> \(u_{2n} = \sum_{k=1}^n f_{2k}u_{2n-2k}\)</p> <p>证明：由全概率公式和对于 \(u, f\) 的定义不难推得。</p> <p>有了这一引理，我们对左右两边求和：</p> <p>左式： \(\sum_{n=1}^\infty u_{2n} = \sum_{n=0}^\infty u_{2n} -1\).</p> <p>右式：\(\sum_{n=1}^\infty[\sum_{k=1}^n f_{2k}u_{2n-2k}] = \sum_{k=1}^\infty f_{2k}\sum_{n=0}^\infty u_{2n}\). (?)</p> <p>因此</p> \[\begin{array} \sum\sum_{n=0}^\infty u_{2n}-1 &amp;= \sum_{n=1}^\infty u_{2n} -1 =\sum_{k=1}^\infty f_{2k}\sum_{n=0}^\infty u_{2n} \\ \sum_{n=1}^\infty f_{2n} &amp;= 1 - \frac1{\sum_{n=0}^\infty u_{2n}} \end{array}\] <p>所以我们立刻得到：若级数 \(\sum u_{2n}\) 发散，那么 \(\sum f_{2n} = 1\)，即回到原点的概率为 \(1\). 反之，则回到原点的概率小于 \(1\).</p> <p>首先在二维随机游走中，我们求概率 \(u_{2n}\), 总路线有 \(4^{2n}\) 条，而回到原点则要求向上和向下的路线数相等，向左和向右的路线数相等，因此这样的路线为：</p> \[\sum_{k=0}^n\frac{(2n)!}{k!k!(n-k)!(n-k)!} = C_{2n}^n\sum_{k=0}^n (C_n^k)^2 = (C_{2n}^n)^2\] <p>那么同样利用斯特林公式：</p> \[u_{2n} = 4^{-2n}(C_{2n}^n)^2\approx \frac{1}{\pi n}\] <p>显然 \(\sum_{n=2}^\infty u_{2n} = \infty\)，这是一个经典的发散级数，故二维随机游走是回返的。</p> <p>而在三维随机游走中，我们有类似的：</p> \[u_{2n} = 6^{-2n}\sum_{0\le i + j \le n}\frac{(2n)!}{i!i!j!j!(n-i-j)!(n-i-j)!}\] <p>(以下省略一波暴算和估计)</p> <p>可以得到 \(u_{2n} 的数量级为 \frac{1}{n^{3/2}}\)，因此 \(\sum_{n=2}^\infty u_{2n} &lt; \infty\)，故三维随机游走是非回返的。经计算，回返的概率大约是 \(0.35\).</p> <p>综上所述，一维随机游动的一条极好性质——回返性，在二维空间仍然成立，然而在三维及三维以上空间就不满足了。</p> <blockquote> <p>随机游走的回返性最终与p级数的收敛性相关，这是一个非常有趣的结论。</p> </blockquote> <h2 id="参考资料">参考资料</h2> <p>柯尔莫哥洛夫. 《概率论导引》. 本文主要是对其第四章内容的总结与笔记。</p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Qi Zhan. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: December 11, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>